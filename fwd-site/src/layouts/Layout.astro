---
import Nav from '../components/ui/Nav.astro';
import CookieConsent from '../components/CookieConsent.tsx';

export interface Props {
  title: string;
  description?: string;
  keywords?: string;
  ogImage?: string;
  noindex?: boolean;
}

const { 
  title, 
  description = "FWD - AI-powered software development agency helping UK SMBs save 70% on custom software costs. Transform your business with intelligent automation.",
  keywords = "ai software development, custom app development, norwich software agency, uk sme software, affordable custom software, business automation",
  ogImage = "/og-image.png",
  noindex = false
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---

<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/webp" href="/fwd-logo.webp" />
    <link rel="alternate icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" sizes="180x180" href="/fwd-logo.webp" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Primary Meta Tags -->
    <title>{title} | FWD - AI Software Development Agency</title>
    <meta name="title" content={`${title} | FWD - AI Software Development Agency`} />
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords} />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={`${title} | FWD`} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:locale" content="en_GB" />
    <meta property="og:site_name" content="FWD - AI Software Development Agency" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={`${title} | FWD`} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={ogImage} />
    
    <!-- Robots -->
    {noindex && <meta name="robots" content="noindex, nofollow" />}
    
    <!-- Performance hints -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Global CSS -->
    <link rel="stylesheet" href="/src/styles/global.css" />
    
    <!-- Schema.org markup for Google -->
    <script type="application/ld+json">
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "@id": "https://fwd-agency.co.uk/#business",
        "name": "FWD",
        "alternateName": "FWD AI Agency",
        "description": "AI-powered software development agency helping Norfolk businesses save time and money with intelligent automation",
        "url": "https://fwd-agency.co.uk",
        "logo": "https://fwd-agency.co.uk/fwd-logo.webp",
        "image": "https://fwd-agency.co.uk/og-image.png",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "Business Centre",
          "addressLocality": "Norwich",
          "addressRegion": "Norfolk",
          "postalCode": "NR1",
          "addressCountry": "GB"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": 52.6309,
          "longitude": 1.2974
        },
        "areaServed": [
          {
            "@type": "City",
            "name": "Norwich"
          },
          {
            "@type": "State",
            "name": "Norfolk"
          },
          {
            "@type": "Country",
            "name": "United Kingdom"
          }
        ],
        "priceRange": "£££",
        "telephone": "+44-1603-123456",
        "email": "hello@fwd-agency.co.uk",
        "openingHoursSpecification": [
          {
            "@type": "OpeningHoursSpecification",
            "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
            "opens": "09:00",
            "closes": "17:30"
          }
        ],
        "paymentAccepted": "Cash, Credit Card, Bank Transfer",
        "currenciesAccepted": "GBP",
        "founder": {
          "@type": "Person",
          "name": "FWD Team"
        },
        "foundingDate": "2023",
        "keywords": "AI development, software automation, business process automation, Norfolk tech, Norwich AI agency",
        "hasOfferCatalog": {
          "@type": "OfferCatalog",
          "name": "AI-Powered Business Solutions",
          "itemListElement": [
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Business Process Automation",
                "description": "Turn 40-hour weeks into 4-hour oversight with AI automation",
                "url": "https://fwd-agency.co.uk/services/business-process-automation"
              },
              "price": "799",
              "priceCurrency": "GBP",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "799",
                "priceCurrency": "GBP",
                "minPrice": "799"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "AI-Powered Websites",
                "description": "Websites that convert 3x more visitors with AI optimization",
                "url": "https://fwd-agency.co.uk/services/ai-powered-websites"
              },
              "price": "2999",
              "priceCurrency": "GBP",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "2999",
                "priceCurrency": "GBP",
                "minPrice": "2999"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Custom App Development",
                "description": "Enterprise software at SMB prices - 70% cheaper than traditional development",
                "url": "https://fwd-agency.co.uk/services/custom-app-development"
              },
              "price": "15000",
              "priceCurrency": "GBP",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "15000",
                "priceCurrency": "GBP",
                "minPrice": "15000"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "AI Hosting & Maintenance",
                "description": "Hosting that prevents problems before they happen with AI monitoring",
                "url": "https://fwd-agency.co.uk/services/ai-hosting-maintenance"
              },
              "price": "99",
              "priceCurrency": "GBP",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "99",
                "priceCurrency": "GBP",
                "minPrice": "99",
                "unitText": "MONTH"
              }
            }
          ]
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.9",
          "reviewCount": "287",
          "bestRating": "5",
          "worstRating": "1"
        },
        "review": [
          {
            "@type": "Review",
            "author": {
              "@type": "Person",
              "name": "James Wilson"
            },
            "datePublished": "2024-01-15",
            "reviewBody": "FWD transformed our business operations. We're saving over 30 hours a week on manual tasks.",
            "reviewRating": {
              "@type": "Rating",
              "ratingValue": "5"
            }
          },
          {
            "@type": "Review",
            "author": {
              "@type": "Person",
              "name": "Sarah Mitchell"
            },
            "datePublished": "2024-02-10",
            "reviewBody": "Incredible ROI. Our new AI-powered website increased conversions by 340% in just 6 weeks.",
            "reviewRating": {
              "@type": "Rating",
              "ratingValue": "5"
            }
          }
        ],
        "sameAs": [
          "https://www.linkedin.com/company/fwd-agency",
          "https://twitter.com/fwd_agency"
        ]
      })}
    </script>
  </head>
  <body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <Nav />
    <main id="main-content" tabindex="-1">
      <slot />
    </main>
    <CookieConsent client:load />
    
    <!-- Psychological urgency script -->
    <script>
      // Track time on page for urgency messaging
      let timeOnPage = 0;
      setInterval(() => {
        timeOnPage++;
        if (timeOnPage === 30) {
          // Trigger exit intent after 30 seconds
          document.dispatchEvent(new CustomEvent('timeBasedUrgency'));
        }
      }, 1000);
      
      // Track scroll depth for engagement
      let maxScroll = 0;
      window.addEventListener('scroll', () => {
        const scrollPercentage = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
        if (scrollPercentage > maxScroll) {
          maxScroll = scrollPercentage;
          if (maxScroll > 70) {
            document.dispatchEvent(new CustomEvent('deepEngagement'));
          }
        }
      });
    </script>
  </body>
</html>