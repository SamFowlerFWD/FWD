---
import Nav from '../components/ui/Nav.astro';
import Footer from '../components/ui/Footer.astro';
import Breadcrumbs from '../components/ui/Breadcrumbs.astro';
import CookieConsent from '../components/CookieConsent.tsx';
import '../styles/global.css';

export interface Props {
  title: string;
  description?: string;
  keywords?: string;
  ogImage?: string;
  noindex?: boolean;
  hideBreadcrumbs?: boolean;
}

const {
  title,
  description = "Professional web development and business automation in Norwich, Norfolk. Websites, apps, booking systems and hosting for UK businesses.",
  keywords = "web development norwich, custom app development, business automation norfolk, website hosting uk",
  ogImage = "/og-image.png",
  noindex = false,
  hideBreadcrumbs = false
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const isHomepage = Astro.url.pathname === '/' || Astro.url.pathname === '';
---

<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/webp" href="/fwd-logo.webp" />
    <link rel="alternate icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" sizes="180x180" href="/fwd-logo.webp" />
    <meta name="generator" content={Astro.generator} />

    <!-- Primary Meta Tags -->
    <title>{title} | FWD Thinking Solutions</title>
    <meta name="title" content={`${title} | FWD Thinking Solutions`} />
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords} />

    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={`${title} | FWD Thinking Solutions`} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:locale" content="en_GB" />
    <meta property="og:site_name" content="FWD Thinking Solutions" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={`${title} | FWD Thinking Solutions`} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={ogImage} />

    <!-- Robots -->
    {noindex && <meta name="robots" content="noindex, nofollow" />}

    <!-- Performance hints -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Schema.org markup for Google -->
    <script type="application/ld+json">
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": ["ProfessionalService", "LocalBusiness"],
        "@id": "https://f-w-d.co.uk/#business",
        "name": "FWD Thinking Solutions",
        "alternateName": "FWD",
        "description": "Web development and business automation agency helping businesses in Norfolk and across the UK save time and money with practical technology solutions",
        "url": "https://f-w-d.co.uk",
        "logo": "https://f-w-d.co.uk/fwd-logo.webp",
        "image": "https://f-w-d.co.uk/og-image.png",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Norwich",
          "addressRegion": "Norfolk",
          "postalCode": "NR1",
          "addressCountry": "GB"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": 52.6309,
          "longitude": 1.2974
        },
        "areaServed": [
          {
            "@type": "City",
            "name": "Norwich"
          },
          {
            "@type": "State",
            "name": "Norfolk"
          },
          {
            "@type": "Country",
            "name": "United Kingdom"
          }
        ],
        "priceRange": "££",
        "openingHoursSpecification": [
          {
            "@type": "OpeningHoursSpecification",
            "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
            "opens": "09:00",
            "closes": "17:30"
          }
        ],
        "paymentAccepted": "Cash, Credit Card, Bank Transfer",
        "currenciesAccepted": "GBP",
        "founder": {
          "@type": "Person",
          "name": "Sam Fowler"
        },
        "foundingDate": "2023",
        "knowsAbout": ["Web Development", "Business Automation", "Custom Software", "Mobile App Development", "SEO"],
        "hasOfferCatalog": {
          "@type": "OfferCatalog",
          "name": "Web Development & Business Solutions",
          "itemListElement": [
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Business Process Automation",
                "description": "Automate repetitive business tasks including invoicing, emails, data entry and scheduling",
                "url": "https://f-w-d.co.uk/services/business-process-automation"
              },
              "price": "799",
              "priceCurrency": "GBP",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "799",
                "priceCurrency": "GBP",
                "minPrice": "799"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Professional Websites",
                "description": "Fast, mobile-friendly, SEO-optimised websites for businesses",
                "url": "https://f-w-d.co.uk/services/professional-websites"
              },
              "price": "299",
              "priceCurrency": "GBP",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "299",
                "priceCurrency": "GBP",
                "minPrice": "299"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Custom App Development",
                "description": "Bespoke web and mobile applications including booking systems, dashboards and internal tools",
                "url": "https://f-w-d.co.uk/services/custom-app-development"
              },
              "price": "1299",
              "priceCurrency": "GBP",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "1299",
                "priceCurrency": "GBP",
                "minPrice": "1299"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Hosting & Maintenance",
                "description": "Reliable hosting with daily backups, security updates, performance monitoring and support",
                "url": "https://f-w-d.co.uk/services/reliable-hosting-maintenance"
              },
              "price": "99",
              "priceCurrency": "GBP",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "99",
                "priceCurrency": "GBP",
                "minPrice": "99",
                "unitText": "MONTH"
              }
            }
          ]
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "5.0",
          "reviewCount": "2",
          "bestRating": "5"
        },
        "review": [
          {
            "@type": "Review",
            "author": {
              "@type": "Person",
              "name": "Anna Kidd"
            },
            "datePublished": "2024-01-15",
            "reviewBody": "Sam really listens to the client's brief and adds value to their ideas. He is naturally creative and takes time to understand and produce amazing outcomes. Highly recommended.",
            "reviewRating": {
              "@type": "Rating",
              "ratingValue": "5"
            }
          },
          {
            "@type": "Review",
            "author": {
              "@type": "Person",
              "name": "Matt Miller"
            },
            "datePublished": "2024-02-10",
            "reviewBody": "We're on the first page of Google in the UK for 'used gym equipment'. For website building and general techy scheming, Sam knows what he's doing!",
            "reviewRating": {
              "@type": "Rating",
              "ratingValue": "5"
            }
          }
        ],
        "sameAs": []
      })}
    </script>
  </head>
  <body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <Nav />
    <main id="main-content" tabindex="-1">
      {!isHomepage && !hideBreadcrumbs && <Breadcrumbs path={Astro.url.pathname} />}
      <slot />
    </main>
    <Footer />
    <CookieConsent client:load />

    <!-- Scroll-reveal animation observer -->
    <script>
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

      document.querySelectorAll('[data-animate]').forEach(el => observer.observe(el));
    </script>
  </body>
</html>
